<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ุฏูุฑู EA FC 26 ุงูุฑูุถุงูู</title>
    <!-- Tailwind via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM via CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for in-browser JSX compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-slate-950 text-slate-200">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;
      const ADMIN_PASSWORD = 'Qq112233';
      const STORAGE_KEY = 'ea_fc_26_full_state_v1';

      function App() {
        const [isAdmin, setIsAdmin] = useState(false);
        const [activeTab, setActiveTab] = useState('viewer'); // viewer | admin
        const [bottomTab, setBottomTab] = useState('main'); // main | matches | players | settings
        const [showPasswordPrompt, setShowPasswordPrompt] = useState(false);
        const [passwordInput, setPasswordInput] = useState('');
        const [passwordError, setPasswordError] = useState('');
        const [matchFilter, setMatchFilter] = useState('all');
        const [saveMessage, setSaveMessage] = useState('');
        const [selectedPlayerId, setSelectedPlayerId] = useState(null);
        const [showAddModal, setShowAddModal] = useState(false);
        const [addVisitorName, setAddVisitorName] = useState('');
        const [addVisitorNote, setAddVisitorNote] = useState('');
        const [addMatchResult, setAddMatchResult] = useState({ matchId: '', score1: '', score2: '' });
        const [pendingSuggestions, setPendingSuggestions] = useState([]);

        const [tournamentInfo, setTournamentInfo] = useState({
          name: 'ุฏูุฑู EA FC ุงูุฑูุถุงูู',
          type: 'ุฏูุฑู (ุงูุฌููุน ุถุฏ ุงูุฌููุน)',
          duration: 'ุทูุงู ุดูุฑ ุฑูุถุงู',
          rules:
            '- ูุฏุฉ ุงูุดูุท 6 ุฏูุงุฆู\n- ุงููุณุชูู ูุญุชุฑู\n- ูููุน ุชูุฑุงุฑ ุงููุฑูู ูู ููุณ ุงูุฌููุฉ',
        });

        const [players, setPlayers] = useState([
          { id: 1, name: 'ุฃุญูุฏ (ุฑูุงู ูุฏุฑูุฏ)', note: 'ุจุทู ุงููุณุฎุฉ ุงูุณุงุจูุฉ' },
          { id: 2, name: 'ุฎุงูุฏ (ูุงูุดุณุชุฑ ุณูุชู)', note: '' },
          { id: 3, name: 'ุนูุฑ (ุจุงูุฑู ููููุฎ)', note: '' },
          { id: 4, name: 'ุณุนุฏ (ุจุฑุดูููุฉ)', note: '' },
        ]);

        const [matches, setMatches] = useState([]);
        const [standings, setStandings] = useState([]);
        const [newPlayer, setNewPlayer] = useState({ name: '', note: '' });

        // --- Persistence ---
        useEffect(() => {
          try {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
              const parsed = JSON.parse(saved);
              if (parsed.tournamentInfo) setTournamentInfo(parsed.tournamentInfo);
              if (parsed.players) setPlayers(parsed.players);
              if (parsed.matches) setMatches(parsed.matches);
              if (parsed.standings) setStandings(parsed.standings);
              if (parsed.pendingSuggestions)
                setPendingSuggestions(parsed.pendingSuggestions);
            }
          } catch (e) {
            console.warn('Failed to load saved state', e);
          }
        }, []);

        useEffect(() => {
          const data = {
            tournamentInfo,
            players,
            matches,
            standings,
            pendingSuggestions,
          };
          try {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
          } catch (e) {
            console.warn('Failed to save state', e);
          }
        }, [tournamentInfo, players, matches, standings, pendingSuggestions]);

        // --- Logic Functions ---
        const generateSchedule = () => {
          if (players.length < 2) {
            alert('ูุฌุจ ุฅุถุงูุฉ ูุงุนุจูู ุงุซููู ุนูู ุงูุฃูู ูุชูููุฏ ุงูุฌุฏูู.');
            return;
          }
          const confirmOverwrite =
            matches.length === 0 ||
            confirm('ุณูุชู ุงุณุชุจุฏุงู ุฌุฏูู ุงููุจุงุฑูุงุช ุงูุญุงูู. ูู ุชุฑูุฏ ุงููุชุงุจุนุฉุ');
          if (!confirmOverwrite) return;

          const newMatches = [];
          let matchId = 1;
          for (let i = 0; i < players.length; i++) {
            for (let j = i + 1; j < players.length; j++) {
              newMatches.push({
                id: matchId++,
                team1: players[i],
                team2: players[j],
                score1: '',
                score2: '',
                date: 'ูุญุฏุฏ ูุงุญูุงู',
                time: '--:--',
                isPlayed: false,
              });
            }
          }
          setMatches(newMatches);
          calculateStandings(newMatches, players);
        };

        const calculateStandings = (currentMatches, currentPlayers) => {
          let stats = {};
          currentPlayers.forEach((p) => {
            stats[p.id] = {
              ...p,
              played: 0,
              won: 0,
              drawn: 0,
              lost: 0,
              gf: 0,
              ga: 0,
              points: 0,
            };
          });

          currentMatches.forEach((match) => {
            if (match.isPlayed && match.score1 !== '' && match.score2 !== '') {
              const s1 = parseInt(match.score1);
              const s2 = parseInt(match.score2);
              if (Number.isNaN(s1) || Number.isNaN(s2)) return;
              const t1 = match.team1.id;
              const t2 = match.team2.id;
              if (!stats[t1] || !stats[t2]) return;
              stats[t1].played += 1;
              stats[t2].played += 1;
              stats[t1].gf += s1;
              stats[t1].ga += s2;
              stats[t2].gf += s2;
              stats[t2].ga += s1;
              if (s1 > s2) {
                stats[t1].won += 1;
                stats[t1].points += 3;
                stats[t2].lost += 1;
              } else if (s2 > s1) {
                stats[t2].won += 1;
                stats[t2].points += 3;
                stats[t1].lost += 1;
              } else {
                stats[t1].drawn += 1;
                stats[t2].drawn += 1;
                stats[t1].points += 1;
                stats[t2].points += 1;
              }
            }
          });

          const standingsArray = Object.values(stats).sort((a, b) => {
            if (b.points !== a.points) return b.points - a.points;
            const gdA = a.gf - a.ga;
            const gdB = b.gf - b.ga;
            if (gdB !== gdA) return gdB - gdA;
            return b.gf - a.gf;
          });
          setStandings(standingsArray);
        };

        useEffect(() => {
          if (standings.length === 0 && players.length > 0) {
            calculateStandings(matches, players);
          }
          // eslint-disable-next-line react-hooks/exhaustive-deps
        }, []);

        const handleAddPlayer = () => {
          if (!newPlayer.name.trim()) return;
          const addedPlayer = {
            id: Date.now(),
            name: newPlayer.name.trim(),
            note: newPlayer.note.trim(),
          };
          const updatedPlayers = [...players, addedPlayer];
          setPlayers(updatedPlayers);
          setNewPlayer({ name: '', note: '' });
          calculateStandings(matches, updatedPlayers);
        };

        const handleRemovePlayer = (id) => {
          const updatedPlayers = players.filter((p) => p.id !== id);
          setPlayers(updatedPlayers);
        };

        const handleMatchScoreChange = (id, field, value) => {
          const updatedMatches = matches.map((m) => {
            if (m.id === id) {
              const updatedMatch = { ...m, [field]: value };
              const hasScores =
                updatedMatch.score1 !== '' && updatedMatch.score2 !== '';
              updatedMatch.isPlayed = hasScores;
              return updatedMatch;
            }
            return m;
          });
          setMatches(updatedMatches);
        };

        const handleResetTournament = () => {
          if (
            confirm(
              'ุณูุชู ูุณุญ ุฌุฏูู ุงููุจุงุฑูุงุช ูุงูุชุฑุชูุจ ุงูุญุงูู ูุงูุงุญุชูุงุธ ุจุงููุงุนุจูู ูุงูููุงููู. ูู ุชุฑูุฏ ุงููุชุงุจุนุฉุ'
            )
          ) {
            setMatches([]);
            setStandings([]);
            setMatchFilter('all');
            setSelectedPlayerId(null);
          }
        };

        const filteredMatches = matches.filter((m) => {
          if (matchFilter === 'played') return m.isPlayed;
          if (matchFilter === 'upcoming') return !m.isPlayed;
          return true;
        });

        const playedCount = matches.filter((m) => m.isPlayed).length;

        const handleQuickAdd = () => {
          if (isAdmin) {
            // ูุฏูุฑ: ุฅุถุงูุฉ ูุชูุฌุฉ ููุจุงุฑุงุฉ ููุฌูุฏุฉ
            setAddMatchResult({ matchId: '', score1: '', score2: '' });
          } else {
            // ุฒุงุฆุฑ: ุงูุชุฑุงุญ ูุชูุฌุฉ
            setAddVisitorName('');
            setAddVisitorNote('');
          }
          setShowAddModal(true);
        };

        const handleConfirmAdd = () => {
          if (isAdmin) {
            if (!matches.length) {
              alert('ูุง ุชูุฌุฏ ูุจุงุฑูุงุช. ุงุณุชุฎุฏู ุชูููุฏ ุงูุฌุฏูู ุฃููุงู.');
              return;
            }
            const { matchId, score1, score2 } = addMatchResult;
            const matchIndex = matches.findIndex((m) => m.id === Number(matchId));
            if (matchIndex === -1) {
              alert('ุงุฎุชุฑ ูุจุงุฑุงุฉ ุตุญูุญุฉ.');
              return;
            }
            if (score1 === '' || score2 === '') {
              alert('ุฃุฏุฎู ุงููุชูุฌุชูู.');
              return;
            }
            const updatedMatches = [...matches];
            updatedMatches[matchIndex] = {
              ...updatedMatches[matchIndex],
              score1,
              score2,
              isPlayed: true,
            };
            setMatches(updatedMatches);
            calculateStandings(updatedMatches, players);
            setShowAddModal(false);
          } else {
            if (!addVisitorName.trim() || !addVisitorNote.trim()) {
              setPasswordError('ุฃููู ุงูุงุณู ูุงููุชูุฌุฉ ุงูููุชุฑุญุฉ.');
              return;
            }
            const suggestion = {
              id: Date.now(),
              name: addVisitorName.trim(),
              text: addVisitorNote.trim(),
            };
            setPendingSuggestions([...pendingSuggestions, suggestion]);
            setShowAddModal(false);
            alert('ุชู ุฅุฑุณุงู ุงูุชุฑุงุญู ูููุฏูุฑ ูููุฑุงุฌุนุฉ.');
          }
        };

        const handleAcceptSuggestion = (id) => {
          setPendingSuggestions(pendingSuggestions.filter((s) => s.id !== id));
        };

        const handleRejectSuggestion = (id) => {
          setPendingSuggestions(pendingSuggestions.filter((s) => s.id !== id));
        };

        const ViewMode = () => (
          <div className="space-y-6 pb-16">
            {/* Standings */}
            {(bottomTab === 'main' || bottomTab === 'players') && (
              <div className="bg-slate-900 rounded-2xl border border-slate-800 overflow-hidden shadow-lg">
                <div className="p-4 bg-slate-800/50 border-b border-slate-700/50 flex items-center gap-3">
                  <span className="text-yellow-500 text-lg">๐</span>
                  <h2 className="text-lg font-bold text-white">ุชุฑุชูุจ ุงูุฏูุฑู</h2>
                  <span className="text-xs text-slate-400 ms-auto">ููุญุชุณุจ ุขููุงู</span>
                </div>
                <div className="overflow-x-auto">
                  <table className="w-full text-sm text-right text-slate-300">
                    <thead className="text-xs text-slate-400 bg-slate-800/30 uppercase">
                      <tr>
                        <th className="px-4 py-3 font-semibold">ุงููุฑูุฒ</th>
                        <th className="px-4 py-3 font-semibold">ุงููุงุนุจ</th>
                        <th className="px-4 py-3 font-semibold text-center">ูุนุจ</th>
                        <th className="px-4 py-3 font-semibold text-center text-green-400">ูุงุฒ</th>
                        <th className="px-4 py-3 font-semibold text-center text-slate-400">ุชุนุงุฏู</th>
                        <th className="px-4 py-3 font-semibold text-center text-red-400">ุฎุณุฑ</th>
                        <th className="px-4 py-3 font-semibold text-center">+ / -</th>
                        <th className="px-4 py-3 font-semibold text-center text-yellow-500 text-base">ุงูููุงุท</th>
                      </tr>
                    </thead>
                    <tbody>
                      {standings.map((team, index) => (
                        <tr
                          key={team.id}
                          className={`border-b border-slate-800 hover:bg-slate-800/20 transition-colors cursor-pointer ${
                            selectedPlayerId === team.id ? 'bg-slate-800/40' : ''
                          }`}
                          onClick={() => setSelectedPlayerId(team.id)}
                        >
                          <td className="px-4 py-3 font-bold text-slate-500">{index + 1}</td>
                          <td className="px-4 py-3 font-medium text-white">{team.name}</td>
                          <td className="px-4 py-3 text-center">{team.played}</td>
                          <td className="px-4 py-3 text-center text-green-400/80">{team.won}</td>
                          <td className="px-4 py-3 text-center text-slate-400/80">{team.drawn}</td>
                          <td className="px-4 py-3 text-center text-red-400/80">{team.lost}</td>
                          <td className="px-4 py-3 text-center" dir="ltr">{team.gf} : {team.ga}</td>
                          <td className="px-4 py-3 text-center font-bold text-yellow-500 text-base">{team.points}</td>
                        </tr>
                      ))}
                      {standings.length === 0 && (
                        <tr>
                          <td colSpan="8" className="px-4 py-8 text-center text-slate-500">
                            ูุง ููุฌุฏ ุจูุงูุงุช ูุนุฑุถูุง ุญุชู ุงูุขู.
                          </td>
                        </tr>
                      )}
                    </tbody>
                  </table>
                </div>
                {selectedPlayerId && (
                  <div className="border-t border-slate-800 p-4 text-sm text-slate-300 bg-slate-950/40">
                    {(() => {
                      const p = standings.find((s) => s.id === selectedPlayerId);
                      if (!p) return null;
                      return (
                        <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                          <div>
                            <div className="text-white font-bold">{p.name}</div>
                            <div className="text-xs text-slate-400">
                              ูุจุงุฑูุงุช: {p.played} | ููุฒ: {p.won} | ุชุนุงุฏู: {p.drawn} | ุฎุณุงุฑุฉ: {p.lost}
                            </div>
                          </div>
                          <div className="text-xs text-slate-400">
                            ุฃูุฏุงู: {p.gf} ูู / {p.ga} ุนููู | ูุงุฑู: {p.gf - p.ga} | ููุงุท: {p.points}
                          </div>
                        </div>
                      );
                    })()}
                  </div>
                )}
              </div>
            )}

            {/* Matches */}
            {(bottomTab === 'main' || bottomTab === 'matches') && (
              <div className="bg-slate-900 rounded-2xl border border-slate-800 overflow-hidden shadow-lg">
                <div className="p-4 bg-slate-800/50 border-b border-slate-700/50 flex flex-col sm:flex-row sm:items-center justify-between gap-3">
                  <div className="flex items-center gap-3">
                    <span className="text-blue-400 text-lg">๐</span>
                    <h2 className="text-lg font-bold text-white">ุฌุฏูู ุงููุจุงุฑูุงุช</h2>
                  </div>
                  <div className="flex items-center gap-2 text-xs text-slate-400">
                    <span>ุงููุจุงุฑูุงุช ุงูููุนูุจุฉ: {playedCount} / {matches.length}</span>
                    <div className="flex bg-slate-900 rounded-full border border-slate-700 overflow-hidden">
                      {['all', 'played', 'upcoming'].map((f) => (
                        <button
                          key={f}
                          className={`px-3 py-1 ${
                            matchFilter === f
                              ? 'bg-slate-700 text-yellow-400'
                              : 'text-slate-400'
                          }`}
                          onClick={() => setMatchFilter(f)}
                        >
                          {f === 'all'
                            ? 'ุงููู'
                            : f === 'played'
                            ? 'ุงูููุนูุจุฉ'
                            : 'ุงููุงุฏูุฉ'}
                        </button>
                      ))}
                    </div>
                  </div>
                </div>
                <div className="p-4 space-y-3">
                  {filteredMatches.length === 0 ? (
                    <p className="text-center text-slate-500 py-4">
                      ูุง ุชูุฌุฏ ูุจุงุฑูุงุช ูู ูุฐุง ุงูููุชุฑ.
                    </p>
                  ) : (
                    filteredMatches.map((match) => (
                      <div
                        key={match.id}
                        className={`flex flex-col md:flex-row items-center justify-between rounded-xl p-3 border ${
                          match.isPlayed
                            ? 'bg-slate-900 border-green-900/50'
                            : 'bg-slate-900 border-slate-800'
                        }`}
                      >
                        <div className="text-xs text-slate-400 mb-2 md:mb-0 w-full md:w-auto text-center md:text-right">
                          <span>{match.date}</span> - <span>{match.time}</span>
                        </div>
                        <div className="flex items-center justify-center gap-4 flex-1 w-full">
                          <div className="text-sm font-medium text-white text-left flex-1 truncate">
                            {match.team1.name}
                          </div>
                          <div className="flex items-center justify-center bg-slate-950 rounded-lg px-4 py-1.5 min-w-[80px] border border-slate-700">
                            {match.isPlayed ? (
                              <span className="font-bold text-yellow-500 tracking-widest">
                                {match.score1} - {match.score2}
                              </span>
                            ) : (
                              <span className="text-slate-500 text-xs">VS</span>
                            )}
                          </div>
                          <div className="text-sm font-medium text-white text-right flex-1 truncate">
                            {match.team2.name}
                          </div>
                        </div>
                      </div>
                    ))
                  )}
                </div>
              </div>
            )}

            {/* Players list for viewers */}
            {bottomTab === 'players' && (
              <div className="bg-slate-900 rounded-2xl border border-slate-800 overflow-hidden shadow-lg">
                <div className="p-4 bg-slate-800/50 border-b border-slate-700/50 flex items-center gap-3">
                  <span className="text-blue-400 text-lg">๐ฅ</span>
                  <h2 className="text-lg font-bold text-white">ูุงุฆูุฉ ุงููุงุนุจูู</h2>
                </div>
                <div className="p-4 grid grid-cols-1 md:grid-cols-2 gap-3">
                  {players.map((p) => (
                    <div
                      key={p.id}
                      className="bg-slate-800/60 border border-slate-700 rounded-lg p-3"
                    >
                      <div className="text-white font-medium mb-1">{p.name}</div>
                      {p.note && (
                        <div className="text-xs text-slate-400">{p.note}</div>
                      )}
                    </div>
                  ))}
                  {players.length === 0 && (
                    <div className="col-span-full text-center text-slate-500 text-sm">
                      ูุง ููุฌุฏ ูุงุนุจูู ูุถุงููู.
                    </div>
                  )}
                </div>
              </div>
            )}

            {/* Viewer settings */}
            {bottomTab === 'settings' && (
              <div className="bg-slate-900 rounded-2xl border border-slate-800 overflow-hidden shadow-lg">
                <div className="p-4 bg-slate-800/50 border-b border-slate-700/50 flex items-center gap-3">
                  <span className="text-slate-200 text-lg">โ๏ธ</span>
                  <h2 className="text-lg font-bold text-white">ุฅุนุฏุงุฏุงุช ุงูุนุฑุถ</h2>
                </div>
                <div className="p-5 text-sm text-slate-300">
                  <p className="mb-2">ูุฐู ุงูุฅุนุฏุงุฏุงุช ุชุฎุต ุดูู ุงูุนุฑุถ ููุท:</p>
                  <ul className="list-disc pr-5 text-xs text-slate-400 space-y-1">
                    <li>ุงููุถุน ุงููููู ููุนูู ุงูุชุฑุงุถูุงู ูู ูุฐุง ุงูุชุตููู.</li>
                    <li>ูููู ูุณุชูุจูุงู ุฅุถุงูุฉ ุฎูุงุฑุงุช ูุชูุจูุฑ ุงูุฎุท ุฃู ุชุบููุฑ ุงูุฃููุงู.</li>
                  </ul>
                </div>
              </div>
            )}
          </div>
        );

        const AdminMode = () => (
          <div className="space-y-6 pb-16">
            {/* Settings when bottomTab === main */}
            {bottomTab === 'main' && (
              <>
                <div className="bg-slate-900 rounded-2xl border border-slate-800 overflow-hidden shadow-lg">
                  <div className="p-4 bg-slate-800/50 border-b border-slate-700/50 flex items-center gap-3">
                    <span className="text-slate-400 text-lg">โ๏ธ</span>
                    <h2 className="text-lg font-bold text-white">ุฅุนุฏุงุฏุงุช ุงูุจุทููุฉ</h2>
                  </div>
                  <div className="p-5 space-y-4">
                    <div>
                      <label className="block text-sm text-slate-400 mb-1.5">ุงุณู ุงูุฏูุฑู</label>
                      <input
                        type="text"
                        className="w-full bg-slate-950 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500 transition-all"
                        value={tournamentInfo.name}
                        onChange={(e) =>
                          setTournamentInfo({ ...tournamentInfo, name: e.target.value })
                        }
                      />
                    </div>
                    <div>
                      <label className="block text-sm text-slate-400 mb-1.5">ููุน ุงูุจุทููุฉ</label>
                      <select
                        className="w-full bg-slate-950 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-yellow-500 transition-all appearance-none"
                        value={tournamentInfo.type}
                        onChange={(e) =>
                          setTournamentInfo({ ...tournamentInfo, type: e.target.value })
                        }
                      >
                        <option>ุฏูุฑู (ุงูุฌููุน ุถุฏ ุงูุฌููุน)</option>
                        <option>ุฎุฑูุฌ ุงููุบููุจ</option>
                        <option>ูุฌููุนุงุช ุซู ุฎุฑูุฌ ูุบููุจ</option>
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm text-slate-400 mb-1.5">ูุฏุฉ ุงูุฏูุฑู (ุงุฎุชูุงุฑู)</label>
                      <input
                        type="text"
                        className="w-full bg-slate-950 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-yellow-500 transition-all"
                        value={tournamentInfo.duration}
                        onChange={(e) =>
                          setTournamentInfo({ ...tournamentInfo, duration: e.target.value })
                        }
                      />
                    </div>
                  </div>
                </div>

                <div className="bg-slate-900 rounded-2xl border border-slate-800 overflow-hidden shadow-lg p-5">
                  <h3 className="text-sm font-bold text-slate-400 mb-4">ุฃุฏูุงุช ุงูููุธู</h3>
                  <div className="flex flex-wrap gap-3 mb-3">
                    <button
                      onClick={() => {
                        calculateStandings(matches, players);
                        setSaveMessage('ุชู ุญูุธ ุงูุฅุนุฏุงุฏุงุช ูุชุญุฏูุซ ุงูุชุฑุชูุจ');
                        setTimeout(() => setSaveMessage(''), 2500);
                      }}
                      className="bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-bold px-6 py-3 rounded-xl transition-colors flex items-center gap-2 flex-1 justify-center min-w-[200px]"
                    >
                      ๐พ ุญูุธ ุงูุฅุนุฏุงุฏุงุช ูุชุญุฏูุซ ุงูุชุฑุชูุจ
                    </button>
                    <button
                      onClick={handleResetTournament}
                      className="bg-slate-800 hover:bg-slate-700 text-red-400 border border-red-500/40 font-medium px-6 py-3 rounded-xl transition-colors flex items-center gap-2 justify-center"
                    >
                      ๐งน ุจุฏุก ูุณุฎุฉ ุฌุฏูุฏุฉ (ูุณุญ ุงููุชุงุฆุฌ)
                    </button>
                    <button
                      onClick={() => {
                        setIsAdmin(false);
                        setActiveTab('viewer');
                      }}
                      className="bg-red-500/10 text-red-400 hover:bg-red-500/20 border border-red-500/20 font-medium px-6 py-3 rounded-xl transition-colors flex items-center gap-2 justify-center"
                    >
                      ๐ ุชุณุฌูู ุฎุฑูุฌ
                    </button>
                  </div>
                  {saveMessage && (
                    <div className="text-xs text-green-400 bg-green-500/10 border border-green-500/20 px-3 py-2 rounded-lg inline-flex items-center gap-2">
                      <span className="w-2 h-2 rounded-full bg-green-400"></span>
                      {saveMessage}
                    </div>
                  )}
                </div>
              </>
            )}

            {/* Players when bottomTab === players */}
            {bottomTab === 'players' && (
              <div className="bg-slate-900 rounded-2xl border border-slate-800 overflow-hidden shadow-lg">
                <div className="p-4 bg-slate-800/50 border-b border-slate-700/50 flex items-center justify-between">
                  <div className="flex items-center gap-3">
                    <span className="text-blue-400 text-lg">๐ฅ</span>
                    <h2 className="text-lg font-bold text-white">ุงููุงุนุจูู ({players.length})</h2>
                  </div>
                </div>
                <div className="p-5">
                  <div className="flex flex-col md:flex-row gap-3 mb-6 bg-slate-950 p-4 rounded-xl border border-slate-800">
                    <div className="flex-1">
                      <input
                        type="text"
                        placeholder="ุงุณู ุงููุงุนุจ / ุงููููุฉ (ูุซุงู: ุฃุจู ููุงู)"
                        className="w-full bg-transparent border-b border-slate-700 px-2 py-2 text-white focus:outline-none focus:border-yellow-500"
                        value={newPlayer.name}
                        onChange={(e) => setNewPlayer({ ...newPlayer, name: e.target.value })}
                      />
                    </div>
                    <div className="flex-1">
                      <input
                        type="text"
                        placeholder="ููุงุญุธุฉ (ูุซุงู: ุงููุฑูู ุงูููุถู)"
                        className="w-full bg-transparent border-b border-slate-700 px-2 py-2 text-white text-sm focus:outline-none focus:border-yellow-500"
                        value={newPlayer.note}
                        onChange={(e) => setNewPlayer({ ...newPlayer, note: e.target.value })}
                      />
                    </div>
                    <button
                      onClick={handleAddPlayer}
                      className="bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-bold px-6 py-2 rounded-lg transition-colors flex items-center justify-center gap-2"
                    >
                      <span className="text-lg">๏ผ</span>
                      ุฅุถุงูุฉ
                    </button>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                    {players.map((player) => (
                      <div
                        key={player.id}
                        className="bg-slate-800/50 border border-slate-700 rounded-lg p-3 flex justify-between items-center"
                      >
                        <div>
                          <div className="text-white font-medium">{player.name}</div>
                          {player.note && (
                            <div className="text-xs text-slate-400 mt-0.5">{player.note}</div>
                          )}
                        </div>
                        <button
                          onClick={() => handleRemovePlayer(player.id)}
                          className="text-slate-500 hover:text-red-400 transition-colors p-2"
                          title="ุญุฐู ุงููุงุนุจ"
                        >
                          ๐
                        </button>
                      </div>
                    ))}
                    {players.length === 0 && (
                      <div className="col-span-full text-center py-4 text-slate-500">
                        ูุง ููุฌุฏ ูุงุนุจูู ูุถุงููู.
                      </div>
                    )}
                  </div>
                </div>
              </div>
            )}

            {/* Rules & suggestions when bottomTab === settings */}
            {bottomTab === 'settings' && (
              <>
                <div className="bg-slate-900 rounded-2xl border border-slate-800 overflow-hidden shadow-lg">
                  <div className="p-4 bg-slate-800/50 border-b border-slate-700/50 flex items-center gap-3">
                    <span className="text-purple-400 text-lg">โ๏ธ</span>
                    <h2 className="text-lg font-bold text-white">ููุงููู ุงูุฏูุฑู</h2>
                  </div>
                  <div className="p-5">
                    <textarea
                      className="w-full bg-slate-950 border border-slate-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-yellow-500 transition-all min-h-[120px]"
                      placeholder="ุงูุชุจ ุงูููุงููู ููุงุ ุณุทุฑ ููู ูุงุนุฏุฉ..."
                      value={tournamentInfo.rules}
                      onChange={(e) =>
                        setTournamentInfo({ ...tournamentInfo, rules: e.target.value })
                      }
                    />
                  </div>
                </div>

                {pendingSuggestions.length > 0 && (
                  <div className="bg-slate-900 rounded-2xl border border-slate-800 overflow-hidden shadow-lg p-5">
                    <h3 className="text-sm font-bold text-slate-400 mb-3 flex items-center gap-2">
                      ๐จ ุงูุชุฑุงุญุงุช ุงูุฒูุงุฑ ({pendingSuggestions.length})
                    </h3>
                    <div className="space-y-2 text-xs">
                      {pendingSuggestions.map((s) => (
                        <div
                          key={s.id}
                          className="border border-slate-700 rounded-lg p-3 flex justify-between gap-3 bg-slate-950"
                        >
                          <div>
                            <div className="text-slate-200 font-medium mb-1">
                              {s.name}
                            </div>
                            <div className="text-slate-400 whitespace-pre-wrap">
                              {s.text}
                            </div>
                          </div>
                          <div className="flex flex-col gap-2 text-xs">
                            <button
                              className="bg-green-500/20 text-green-400 border border-green-500/40 rounded px-3 py-1"
                              onClick={() => handleAcceptSuggestion(s.id)}
                            >
                              ูุจูู (ุชูุช ุงููุนุงูุฌุฉ)
                            </button>
                            <button
                              className="bg-red-500/10 text-red-400 border border-red-500/40 rounded px-3 py-1"
                              onClick={() => handleRejectSuggestion(s.id)}
                            >
                              ุชุฌุงูู
                            </button>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}
              </>
            )}

            {/* Matches when bottomTab === matches */}
            {bottomTab === 'matches' && (
              <div className="bg-slate-900 rounded-2xl border border-slate-800 overflow-hidden shadow-lg">
                <div className="p-4 bg-slate-800/50 border-b border-slate-700/50 flex flex-col sm:flex-row sm:items-center justify-between gap-3">
                  <div className="flex items-center gap-3">
                    <span className="text-green-400 text-lg">๐ฎ</span>
                    <h2 className="text-lg font-bold text-white">ุฅุฏุงุฑุฉ ุงููุจุงุฑูุงุช ูุงููุชุงุฆุฌ</h2>
                  </div>
                  <button
                    onClick={generateSchedule}
                    className="bg-slate-800 hover:bg-slate-700 text-white text-sm px-4 py-2 rounded-lg transition-colors border border-slate-600 flex items-center gap-2"
                  >
                    โณ ุชูููุฏ ุงูุฌุฏูู ุชููุงุฆูุงู
                  </button>
                </div>
                <div className="p-4 space-y-3">
                  {matches.length === 0 ? (
                    <div className="text-center py-8 text-slate-500">
                      <span className="text-3xl mb-3 block opacity-40">๐ฎ</span>
                      <p>ูู ูุชู ุฅูุดุงุก ุฌุฏูู ูุจุงุฑูุงุช.</p>
                      <p className="text-xs mt-1">
                        ุงุถุบุท ุนูู "ุชูููุฏ ุงูุฌุฏูู ุชููุงุฆูุงู" ูุฅูุดุงุก ูุจุงุฑูุงุช ุจูู ุฌููุน ุงููุงุนุจูู.
                      </p>
                    </div>
                  ) : (
                    <>
                      <div className="text-xs text-yellow-500/80 mb-4 bg-yellow-500/10 p-3 rounded-lg border border-yellow-500/20">
                        ุฃุฏุฎู ุงููุชุงุฆุฌ ูู ุงููุฑุจุนุงุช ุฃุฏูุงู. ุณูุชู ุงุญุชุณุงุจ ุงูุชุฑุชูุจ ุนูุฏ ุงูุถุบุท ุนูู "ุญูุธ ุงูุฅุนุฏุงุฏุงุช ูุชุญุฏูุซ ุงูุชุฑุชูุจ".
                      </div>
                      <div className="space-y-3">
                        {matches.map((match) => (
                          <div
                            key={match.id}
                            className="flex flex-col md:flex-row items-center justify-between bg-slate-950 rounded-xl p-3 border border-slate-800"
                          >
                            <div className="flex gap-2 w-full md:w-auto mb-3 md:mb-0">
                              <input
                                type="text"
                                placeholder="ุงูุชุงุฑูุฎ"
                                className="bg-slate-900 border border-slate-700 text-slate-300 text-xs rounded px-2 py-1.5 w-full md:w-24 text-center focus:outline-none focus:border-blue-500"
                                value={match.date}
                                onChange={(e) =>
                                  handleMatchScoreChange(match.id, 'date', e.target.value)
                                }
                              />
                              <input
                                type="text"
                                placeholder="ุงูููุช"
                                className="bg-slate-900 border border-slate-700 text-slate-300 text-xs rounded px-2 py-1.5 w-full md:w-20 text-center focus:outline-none focus:border-blue-500"
                                value={match.time}
                                onChange={(e) =>
                                  handleMatchScoreChange(match.id, 'time', e.target.value)
                                }
                              />
                            </div>
                            <div className="flex items-center justify-center gap-3 w-full md:w-auto flex-1 px-4">
                              <div className="text-sm font-medium text-white text-left flex-1 truncate">
                                {match.team1.name}
                              </div>
                              <div className="flex items-center gap-2" dir="ltr">
                                <input
                                  type="number"
                                  min="0"
                                  className="w-12 h-10 bg-slate-800 border border-slate-600 rounded-md text-center text-white font-bold focus:outline-none focus:border-yellow-500 focus:bg-slate-700"
                                  value={match.score1}
                                  onChange={(e) =>
                                    handleMatchScoreChange(
                                      match.id,
                                      'score1',
                                      e.target.value
                                    )
                                  }
                                />
                                <span className="text-slate-500">-</span>
                                <input
                                  type="number"
                                  min="0"
                                  className="w-12 h-10 bg-slate-800 border border-slate-600 rounded-md text-center text-white font-bold focus:outline-none focus:border-yellow-500 focus:bg-slate-700"
                                  value={match.score2}
                                  onChange={(e) =>
                                    handleMatchScoreChange(
                                      match.id,
                                      'score2',
                                      e.target.value
                                    )
                                  }
                                />
                              </div>
                              <div className="text-sm font-medium text-white text-right flex-1 truncate">
                                {match.team2.name}
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    </>
                  )}
                </div>
              </div>
            )}
          </div>
        );

        const handleAdminLogin = () => {
          setPasswordInput('');
          setPasswordError('');
          setShowPasswordPrompt(true);
        };

        const handleConfirmPassword = () => {
          if (passwordInput === ADMIN_PASSWORD) {
            setIsAdmin(true);
            setActiveTab('admin');
            setShowPasswordPrompt(false);
            setPasswordInput('');
            setPasswordError('');
          } else {
            setPasswordError('ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ');
          }
        };

        return (
          <div className="min-h-screen bg-slate-950 text-slate-200 font-sans pb-20" dir="rtl">
            {/* Header */}
            <header className="bg-slate-900 border-b border-slate-800 sticky top-0 z-10 shadow-md">
              <div className="max-w-4xl mx-auto px-4 py-4">
                <div className="flex items-center justify-between mb-4">
                  <div className="flex items-center gap-3">
                    <div className="bg-gradient-to-br from-yellow-400 to-yellow-600 p-2 rounded-full shadow-lg shadow-yellow-500/20">
                      <span className="text-slate-900 text-lg">๐</span>
                    </div>
                    <div>
                      <h1 className="text-xl font-black text-white tracking-tight">
                        {tournamentInfo.name}
                      </h1>
                      <p className="text-xs text-slate-400">
                        ุนุฑุถ ุจุณูุท ููุฏูุฑู + ุตูุญุฉ ุฅุฏุงุฑุฉ ููููุธู
                      </p>
                    </div>
                  </div>
                  {!isAdmin && (
                    <button
                      onClick={handleAdminLogin}
                      className="flex items-center gap-2 bg-slate-800 hover:bg-slate-700 text-slate-300 text-xs px-3 py-1.5 rounded-full border border-slate-700 transition-colors"
                    >
                      ๐ ุฏุฎูู ุงููุฏูุฑ
                    </button>
                  )}
                  {isAdmin && (
                    <div className="flex items-center gap-2 bg-green-500/10 text-green-400 text-xs px-3 py-1.5 rounded-full border border-green-500/20">
                      <span className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                      ูุถุน ุงููุฏูุฑ ููุนู
                    </div>
                  )}
                </div>
                <div className="flex bg-slate-950 rounded-xl p-1 border border-slate-800">
                  <button
                    onClick={() => setActiveTab('viewer')}
                    className={`flex-1 text-center py-2.5 rounded-lg text-sm font-semibold transition-all ${
                      activeTab === 'viewer'
                        ? 'bg-slate-800 text-yellow-500 shadow-sm border border-slate-700'
                        : 'text-slate-500 hover:text-slate-300'
                    }`}
                  >
                    ุงูุฏูุฑู (ูููุดุงูุฏ)
                  </button>
                  <button
                    onClick={() => setActiveTab('admin')}
                    className={`flex-1 text-center py-2.5 rounded-lg text-sm font-semibold transition-all ${
                      activeTab === 'admin'
                        ? 'bg-slate-800 text-yellow-500 shadow-sm border border-slate-700'
                        : 'text-slate-500 hover:text-slate-300'
                    }`}
                  >
                    ุงูุฅุฏุงุฑุฉ (ููููุธู)
                  </button>
                </div>
              </div>
            </header>

            <main className="max-w-4xl mx-auto px-4 py-6">
              {activeTab === 'viewer' ? <ViewMode /> : <AdminMode />}
            </main>

            {/* Bottom bar always visible, both modes */}
            <div className="fixed bottom-0 inset-x-0 bg-slate-900 border-t border-slate-800 shadow-[0_-4px_10px_rgba(0,0,0,0.6)]">
              <div className="max-w-4xl mx-auto px-4 py-2 flex items-center justify-between gap-3 text-xs">
                <button
                  onClick={() => setBottomTab('main')}
                  className={`flex flex-col items-center flex-1 ${
                    bottomTab === 'main' ? 'text-yellow-400' : 'text-slate-400'
                  }`}
                >
                  <span>๐</span>
                  <span>ุงูุฑุฆูุณูุฉ</span>
                </button>
                <button
                  onClick={() => setBottomTab('matches')}
                  className={`flex flex-col items-center flex-1 ${
                    bottomTab === 'matches' ? 'text-yellow-400' : 'text-slate-400'
                  }`}
                >
                  <span>๐</span>
                  <span>ุงูุฌุฏูู</span>
                </button>
                <button
                  onClick={handleQuickAdd}
                  className="flex items-center justify-center flex-none w-12 h-12 rounded-full bg-yellow-500 text-slate-900 text-2xl border-4 border-slate-900 -mt-6 shadow-lg"
                  title={
                    isAdmin
                      ? 'ุฅุฏุฎุงู ูุชูุฌุฉ ููุจุงุฑุงุฉ'
                      : 'ุงูุชุฑุงุญ ูุชูุฌุฉ ูููุฏูุฑ'
                  }
                >
                  +
                </button>
                <button
                  onClick={() => setBottomTab('players')}
                  className={`flex flex-col items-center flex-1 ${
                    bottomTab === 'players' ? 'text-yellow-400' : 'text-slate-400'
                  }`}
                >
                  <span>๐ฅ</span>
                  <span>ุงููุงุนุจูู</span>
                </button>
                <button
                  onClick={() => setBottomTab('settings')}
                  className={`flex flex-col items-center flex-1 ${
                    bottomTab === 'settings' ? 'text-yellow-400' : 'text-slate-400'
                  }`}
                >
                  <span>โ๏ธ</span>
                  <span>{isAdmin ? 'ุฅุฏุงุฑุฉ' : 'ุงููุงุฌูุฉ'}</span>
                </button>
              </div>
            </div>

            {/* Password Modal */}
            {showPasswordPrompt && (
              <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-20">
                <div className="bg-slate-900 border border-slate-700 rounded-2xl p-6 w-full max-w-sm mx-4">
                  <h2 className="text-lg font-bold text-white mb-2 flex items-center gap-2">
                    ๐ ุชุณุฌูู ุฏุฎูู ุงููุฏูุฑ
                  </h2>
                  <p className="text-xs text-slate-400 mb-4">
                    ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ ูุชูุนูู ูุถุน ุงูุฅุฏุงุฑุฉ. ูุฐู ุงูุฎุทูุฉ ูุง ุชุคุซุฑ ุฅูุง ุนูู ูุฐุง ุงููุชุตูุญ.
                  </p>
                  <input
                    type="password"
                    className="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-yellow-500 mb-2"
                    placeholder="ูููุฉ ุงููุฑูุฑ"
                    value={passwordInput}
                    onChange={(e) => {
                      setPasswordInput(e.target.value);
                      setPasswordError('');
                    }}
                  />
                  {passwordError && (
                    <p className="text-xs text-red-400 mb-2">{passwordError}</p>
                  )}
                  <div className="flex justify-end gap-2 mt-2">
                    <button
                      className="text-xs px-3 py-1.5 rounded-lg bg-slate-800 text-slate-300 border border-slate-700"
                      onClick={() => {
                        setShowPasswordPrompt(false);
                        setPasswordInput('');
                        setPasswordError('');
                      }}
                    >
                      ุฅูุบุงุก
                    </button>
                    <button
                      className="text-xs px-3 py-1.5 rounded-lg bg-yellow-500 text-slate-900 font-bold"
                      onClick={handleConfirmPassword}
                    >
                      ุชุฃููุฏ
                    </button>
                  </div>
                </div>
              </div>
            )}

            {/* Add Modal (Quick add) */}
            {showAddModal && (
              <div className="fixed inset-0 bg-black/60 flex items-center justify-center z-30">
                <div className="bg-slate-900 border border-slate-700 rounded-2xl p-6 w-full max-w-sm mx-4 text-sm">
                  {isAdmin ? (
                    <>
                      <h2 className="text-lg font-bold text-white mb-2 flex items-center gap-2">
                        โ ุฅุฏุฎุงู ูุชูุฌุฉ ููุจุงุฑุงุฉ
                      </h2>
                      {matches.length === 0 ? (
                        <p className="text-xs text-slate-400 mb-2">
                          ูุง ุชูุฌุฏ ูุจุงุฑูุงุช. ุงุณุชุฎุฏู "ุชูููุฏ ุงูุฌุฏูู" ุฃููุงู.
                        </p>
                      ) : (
                        <>
                          <label className="block text-xs text-slate-400 mb-1">
                            ุงุฎุชุฑ ุงููุจุงุฑุงุฉ
                          </label>
                          <select
                            className="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-1.5 mb-2 text-white text-xs"
                            value={addMatchResult.matchId}
                            onChange={(e) =>
                              setAddMatchResult({
                                ...addMatchResult,
                                matchId: e.target.value,
                              })
                            }
                          >
                            <option value="">ุงุฎุชุฑ ูุจุงุฑุงุฉ</option>
                            {matches.map((m) => (
                              <option key={m.id} value={m.id}>
                                {m.team1.name} vs {m.team2.name} ({m.date} - {m.time})
                              </option>
                            ))}
                          </select>
                          <div className="flex items-center gap-2 mb-2" dir="ltr">
                            <input
                              type="number"
                              min="0"
                              className="w-12 h-9 bg-slate-950 border border-slate-700 rounded-md text-center text-white text-sm"
                              placeholder="0"
                              value={addMatchResult.score1}
                              onChange={(e) =>
                                setAddMatchResult({
                                  ...addMatchResult,
                                  score1: e.target.value,
                                })
                              }
                            />
                            <span className="text-slate-400">-</span>
                            <input
                              type="number"
                              min="0"
                              className="w-12 h-9 bg-slate-950 border border-slate-700 rounded-md text-center text-white text-sm"
                              placeholder="0"
                              value={addMatchResult.score2}
                              onChange={(e) =>
                                setAddMatchResult({
                                  ...addMatchResult,
                                  score2: e.target.value,
                                })
                              }
                            />
                          </div>
                        </>
                      )}
                    </>
                  ) : (
                    <>
                      <h2 className="text-lg font-bold text-white mb-2 flex items-center gap-2">
                        โ๏ธ ุงูุชุฑุงุญ ูุชูุฌุฉ ูููุฏูุฑ
                      </h2>
                      <p className="text-xs text-slate-400 mb-3">
                        ุงุฐูุฑ ุงุณูู ูุงููุชูุฌุฉ ุงูููุชุฑุญุฉ ุฃู ููุงุญุธุฉ ูููุฏูุฑ.
                      </p>
                      <label className="block text-xs text-slate-400 mb-1">ุงุณูู</label>
                      <input
                        type="text"
                        className="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-1.5 mb-2 text-white text-xs"
                        value={addVisitorName}
                        onChange={(e) => setAddVisitorName(e.target.value)}
                        placeholder="ูุซุงู: ุฃุจู ูุญูุฏ"
                      />
                      <label className="block text-xs text-slate-400 mb-1">ุงููุชูุฌุฉ / ุงูููุงุญุธุฉ</label>
                      <textarea
                        className="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 mb-2 text-white text-xs min-h-[80px]"
                        value={addVisitorNote}
                        onChange={(e) => setAddVisitorNote(e.target.value)}
                        placeholder="ูุซุงู: ูุจุงุฑุงุฉ ุฃุญูุฏ ุถุฏ ุฎุงูุฏ ุงูุชูุช 3-2"
                      />
                    </>
                  )}
                  <div className="flex justify-end gap-2 mt-2">
                    <button
                      className="text-xs px-3 py-1.5 rounded-lg bg-slate-800 text-slate-300 border border-slate-700"
                      onClick={() => setShowAddModal(false)}
                    >
                      ุฅูุบุงุก
                    </button>
                    <button
                      className="text-xs px-3 py-1.5 rounded-lg bg-yellow-500 text-slate-900 font-bold"
                      onClick={handleConfirmAdd}
                    >
                      ุชุฃููุฏ
                    </button>
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
